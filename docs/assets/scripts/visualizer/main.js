var RegexVisualizer=function(n){var a,r,i,o=document.querySelector(`#${n.loader_view_id}`),d=o.querySelector(`.${n.progress_bar_class}`),l=new Raphael("graphCtView",10,10);l.canvas.id="graphCtSVG";function e(){var e=window.devicePixelRatio||1;svg=l.getElementsByTagName("svg")[0];var t,n=svg.clientWidth||parseInt(getComputedStyle(svg).width),a=svg.clientHeight||parseInt(getComputedStyle(svg).height),r=new Image;r.width=n,r.height=a,r.setAttribute("src",(t=svg,t=(new XMLSerializer).serializeToString(t),"data:image/svg+xml,"+encodeURIComponent(t)));var i=document.createElement("canvas");i.width=n*e,i.height=a*e,i.style.width=n+"px",i.style.height=a+"px",i.className="exportCanvas";var o=i.getContext("2d");o.setTransform(e,0,0,e,0,0),r.onload=function(){o.drawImage(r,0,0),l.style.display="none",document.body.appendChild(i)}}function c(e,t){n.debug&&(e.innerHTML="",window.setTimeout(()=>JsonView.renderJSON(t,e),50))}function t(){var e,t=u.value,n=I(t);if(n){s.disabled=!0,o.classList.add("loading");d.updateProgressBar=function(e){this.attributes.getNamedItem("data-value").value=`${e}`,this.style.transform=`scaleX(${e/100})`};window.setTimeout(function(){e=visualize(n,b(),l,d),y(e),i&&i(),[a,r,i]=CustomThumbnailSVGControl({mainViewId:"graphCtView",mainSVGId:"graphCtSVG",thumbContainerId:"thumbViewContainer"})},100);return window.setTimeout(function(){o.classList.remove("loading"),d.attributes.getNamedItem("data-value").value="0",d.style.transform="",s.disabled=!1},200),1}return s.disabled=!0,0}var u=document.getElementById("input"),s=(document.getElementById("inputCt"),document.getElementById("visualizeClick")),m=document.getElementById("embedIt"),g=document.getElementById("errorBox"),h=document.getElementsByName("flag"),p=(document.getElementById("flagBox"),function(){g.style.display="none"}),f=function(e,t){g.style.display="block";var n=["Error:"+t.message,""];"number"==typeof t.lastIndex&&(n.push(e),n.push(Kit().repeats("-",t.lastIndex)+"^")),function(e,t){e.innerHTML="";var n=document.createTextNode("");n.nodeValue=t,e.appendChild(n)}(g,n.join("\n"))},v=function(e){var t=S(),n=b();return"#!"+(e.debug?"debug=true&":"")+(e.cmd?"cmd="+e.cmd+"&":"")+(e.embed?"embed=true&":"")+"flags="+n+"&re="+encodeURIComponent(e.re=t)},b=function(){for(var e="",t=0,n=h.length;t<n;t++)h[t].checked&&(e+=h[t].value);return e},y=function(e){var t=document.querySelector(`#${n.raphaelJSONId}`);c(t,e)},w=function(e){e={raw:e.raw.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),groupCount:e.groupCount,tree:e.tree};var t=document.querySelector(`#${n.regexSONId}`);c(t,e)},I=function(t){p();var e=null;try{var n=parse(),e=n(t,null,document.querySelector("[name='languageRegex']:checked").value)}catch(e){if(!(e instanceof n.RegexSyntaxError))throw e;f(t,e)}return e&&w(e),e};u.addEventListener("input",function(e){window.hasChanges=!0,s.disabled=!1}),s.addEventListener("click",function(e){e.detail&&1!=e.detail||t()});var C=function(){var e=location.hash;!e||e.length<2?e={embed:!1,re:"",highlight:!0,flags:""}:((e=(e=e.slice(2)).split("&").reduce(function(e,t){return e[(t=t.split("="))[0]]=t[1],e},{})).embed="true"===e.embed,e.flags=e.flags||"",e.re=e.re?x(decodeURIComponent(e.re)):"");return e}();function x(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}!C.embed&&"export"!=C.cmd||(document.body.className+=" embed");function S(){return x(u.value)}var E;function B(){m.addEventListener("click",function(){if(!I(u.value))return!1;var e=(t=location.href).indexOf("#"),t=0<e?t.slice(0,e):t;location.hash=v(C);e=S(),e='<iframe frameborder="0" width="'+Math.ceil(l.width)+'" height="'+Math.ceil(l.height)+'" src="'+t+"#!embed=true&flags="+b()+"&re="+encodeURIComponent(e)+'"></iframe>';window.prompt("Copy the html code:",e)});let e=document.querySelectorAll("[name='languageRegex']");for(var t=0,n=e.length;t<n;t++)e[t].onclick=function(){o.classList.contains("loading")||s.disabled&&(s.disabled=!1)}}!C.embed&&"export"!==C.cmd||(document.getElementById("embedFooterLink").href=`${document.location.origin}${document.location.pathname}`+location.hash.replace(/\bembed=true\b/gi,"").replace(/\bcmd=export\b/gi,"")),C.flags&&function(e){for(var t=0,n=e.length;t<n;t++)~e.indexOf(h[t].value)?h[t].checked=!0:h[t].checked=!1}(C.flags),C.re&&(E=C.re,u.value=x(E)),"export"!=C.cmd?(B(),t()):e()};