function parse(e,t){var a,i,r,n=Kit();function s(){var e=Object.keys(a).map(function(e){return e+"="+JSON.stringify(a[e])}).join(";");!function(){return this}().eval(e)}function c(e){this.raw=e.raw,this.tree=e.tree,this.groupCount=e.groupCount}function o(e,t){i=t;var a,r=h().input(e,0,t),n=r.stack,n=x.endChoice(n),s=r.lastState;if(!(t=r.acceptable&&r.lastIndex===e.length-1)){switch(s){case"charsetRangeEndWithNullChar":a={type:"CharsetRangeEndWithNullChar",message:"Charset range end with NUL char does not make sense!\nBecause [a-\\0] is not a valid range.\nAnd [\\0-\\0] should be rewritten into [\\0]."};break;case"repeatErrorFinal":a={type:"NothingRepeat",message:"Nothing to repeat!"};break;case"digitFollowNullError":a={type:"DigitFollowNullError",message:"The '\\0' represents the <NUL> char and cannot be followed by a decimal digit!"};break;case"charsetRangeEndClass":a={type:"CharsetRangeEndClass",message:'Charset range ends with class such as "\\w\\W\\d\\D\\s\\S" is invalid!'};break;case"charsetOctEscape":a={type:"DecimalEscape",message:"Decimal escape appears in charset is invalid.Because it can't be explained as  backreference.And octal escape is deprecated!"};break;default:0===s.indexOf("charset")?a={type:"UnclosedCharset",message:"Unterminated character class!"}:")"===e[r.lastIndex]?a={type:"UnmatchedParen",message:"Unmatched end parenthesis!"}:(a={type:"UnexpectedChar",message:"Unexpected char!"},r.lastIndex++)}if(a)throw a.lastIndex=r.lastIndex,a.lastStack=r.stack,a.lastState=s,new E(a)}if(n._parentGroup)throw new E({type:"UnterminatedGroup",message:"Unterminated group!",lastIndex:n._parentGroup.indices[0],lastState:s,lastStack:n});if(t)return t=n.groupCounter?n.groupCounter.i:0,delete n.groupCounter,function a(e,r,t){return e.length?(e.reduce(function(e,t){return t.indices.push(e),t.raw=r.slice(t.indices[0],e),t.type===GROUP_NODE||t.type===ASSERT_NODE&&t.sub?a(t.sub,r,t.endParenIndex):t.type===CHOICE_NODE?(t.branches.reduce(function(e,t){return a(t,r,e),((t=t[0])?t.indices[0]:e)-1},e),t.branches.reverse()):t.type===EXACT_NODE&&(t.concatTemp||(t.chars=t.chars||t.raw)),t.indices[0]},t),void e.reverse()):(e.push({type:EMPTY_NODE,indices:[t,t]}),0)}(n,e,e.length),(t=new c({raw:e,groupCount:t,tree:n=u(n)})).traverse(g,CHARSET_NODE),t.traverse(l,ASSERT_NODE),d(n),i=!1,t}function h(){return r=r||new NFA(k)}function p(e,t,a){Object.defineProperty(e,t,{value:a,enumerable:i,writable:!0,configurable:!0})}function u(e){return e.filter(function(e){return e.type==EXACT_NODE&&e.concatTemp?(delete e.concatTemp,!!e.chars):(e.sub?e.sub=u(e.sub):e.branches&&(e.branches=e.branches.map(u)),!0)})}function d(e){function t(e){e.sub?d(e.sub):e.branches&&e.branches.map(d)}var a=e[0];t(a);for(var r,n=1,s=1,i=e.length;n<i;n++){if((r=e[n]).type===EXACT_NODE){if(a.type===EXACT_NODE&&!a.repeat&&!r.repeat){a.indices[1]=r.indices[1],a.raw+=r.raw,a.chars+=r.chars;continue}}else t(r);a=e[s++]=r}a&&(e.length=s)}function l(e){if(e.repeat){var t=e.assertionType,a="Nothing to repeat! Repeat after assertion doesn't make sense!";throw"AssertLookahead"!==t&&"AssertNegativeLookahead"!==t||(a+="\n/a"+(t="("+("AssertLookahead"===t?"?=":"?!")+"b)")+"+/、/a"+t+"{1,n}/ are the same as /a"+t+"/。\n/a"+t+"*/、/a"+t+"{0,n}/、/a"+t+"?/ are the same as /a/。"),new E({type:"NothingRepeat",lastIndex:e.indices[1]-1,message:a})}}function g(e){e.ranges=n.sortUnique(e.ranges.map(function(e){if(e[0]>e[1])throw new E({type:"OutOfOrder",lastIndex:e.lastIndex,message:"Range ["+e.join("-")+"] out of order in character class!"});return e.join("")}))}function E(e){this.name="RegexSyntaxError",this.type=e.type,this.lastIndex=e.lastIndex,this.lastState=e.lastState,this.lastStack=e.lastStack,this.message=e.message,Object.defineProperty(this,"stack",{value:new Error(e.message).stack,enumerable:!1})}a={EXACT_NODE:"exact",CHARSET_NODE:"charset",CHOICE_NODE:"choice",GROUP_NODE:"group",ASSERT_NODE:"assert",DOT_NODE:"dot",BACKREF_NODE:"backref",EMPTY_NODE:"empty",AssertLookahead:"AssertLookahead",AssertNegativeLookahead:"AssertNegativeLookahead",AssertNonWordBoundary:"AssertNonWordBoundary",AssertWordBoundary:"AssertWordBoundary",AssertEnd:"AssertEnd",AssertBegin:"AssertBegin"},s(),c.prototype.traverse=function(e,r){!function t(e,a){e.forEach(function(e){r&&e.type!==r||a(e),e.sub?t(e.sub,a):e.branches&&e.branches.forEach(function(e){t(e,a)})})}(this.tree,e)},o.Constants=a,o.exportConstants=s,o.RegexSyntaxError=E,o.getNFAParser=h,E.prototype.toString=function(){return this.name+" "+this.type+":"+this.message};var f={n:"\n",r:"\r",t:"\t",v:"\v",f:"\f"},x={escapeStart:function(e,t,a){e.unshift({concatTemp:!0,id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,chars:"",indices:[a]})},exact:function(e,t,a){var r=e[0];(!r||r.type!=EXACT_NODE||r.repeat||r.chars&&!r.concatTemp)&&e.unshift({id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,indices:[a]}),r&&r.concatTemp&&(r.chars+=t)},dot:function(e,t,a){e.unshift({id:Math.random().toString(36).substr(2,9),type:DOT_NODE,indices:[a]})},nullChar:function(e,t,a){e.unshift({id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,chars:"\0",indices:[a-1]})},assertBegin:function(e,t,a){e.unshift({id:Math.random().toString(36).substr(2,9),type:ASSERT_NODE,indices:[a],assertionType:AssertBegin})},assertEnd:function(e,t,a,r,n){e.unshift({id:Math.random().toString(36).substr(2,9),type:ASSERT_NODE,indices:[a],assertionType:AssertEnd})},assertWordBoundary:function(e,t,a){e.unshift({id:Math.random().toString(36).substr(2,9),type:ASSERT_NODE,indices:[a-1],assertionType:"b"==t?AssertWordBoundary:AssertNonWordBoundary})},repeatnStart:function(e,t,a){e[0].type!==EXACT_NODE&&e.unshift({id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,indices:[a]})},repeatnComma:function(e,t,a){p(e[0],"_commaIndex",a)},repeatNonGreedy:function(e){e[0].repeat.nonGreedy=!0},repeatnEnd:function(e,t,a,r,n){var s,i=e[0],c=n.lastIndexOf("{",a),o=parseInt(n.slice(c+1,i._commaIndex||a),10);if(i._commaIndex){if((s=i._commaIndex+1==a?1/0:parseInt(n.slice(i._commaIndex+1,a),10))<o)throw new E({type:"OutOfOrder",lastState:r,lastIndex:a,lastStack:e,message:"Numbers out of order in {} quantifier!"});delete i._commaIndex}else s=o;i.indices[0]>=c&&e.shift(),m(e,o,s,c,n)},repeat1ToInf:function(e,t,a,r,n){m(e,1,1/0,a,n)},repeat0To1:function(e,t,a,r,n){m(e,0,1,a,n)},repeat0ToInf:function(e,t,a,r,n){m(e,0,1/0,a,n)},charClassEscape:function(e,t,a){e.unshift({id:Math.random().toString(36).substr(2,9),type:CHARSET_NODE,indices:[a-1],chars:"",ranges:[],classes:[t],exclude:!1})},normalEscape:function(e,t,a){f.hasOwnProperty(t)&&(t=f[t]),e.unshift({id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,chars:t,indices:[a-1]})},unicodeEscape:function(e,t,a,r,n){t=String.fromCharCode(parseInt(n.slice(a-3,a+1),16)),e.shift(),e.unshift({id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,chars:t,indices:[a-5]})},hexEscape:function(e,t,a,r,n){t=String.fromCharCode(parseInt(n[a-1]+t,16)),e.shift(),e.unshift({id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,chars:t,indices:[a-3]})},groupStart:function(e,t,a){var r=e.groupCounter=e.groupCounter||{i:0};return r.i++,p(e=(a={id:Math.random().toString(36).substr(2,9),type:GROUP_NODE,name:"",num:r.i,sub:[],indices:[a],_parentStack:e}).sub,"_parentGroup",a),e.groupCounter=r,e},groupNonCapture:function(e){var t=e._parentGroup;t.nonCapture=!0,t.num=void 0,e.groupCounter.i--},groupNamedContent:function(e,t){e._parentGroup.name+=t},backref:function(e,t,a,r){var n=e[0],s=parseInt(t,10),t=(t=e.groupCounter)&&t.i||0;if("escape"===r?(n={id:Math.random().toString(36).substr(2,9),type:BACKREF_NODE,indices:[a-1]},e.unshift(n)):s=parseInt(n.num+""+s,10),t<s)throw new E({type:"InvalidBackReference",lastIndex:a,lastStack:e,lastState:r,message:"Back reference number("+s+") greater than current groups count("+t+")."});if(function e(t,a){return!!a._parentGroup&&(a._parentGroup.num==t?t:e(t,a._parentGroup._parentStack))}(s,e))throw new E({type:"InvalidBackReference",lastIndex:a,lastStack:e,lastState:r,message:"Recursive back reference in group ("+s+") itself."});n.num=s},groupToAssertion:function(e,t,a){var r=e._parentGroup;r.type=ASSERT_NODE,r.assertionType="="==t?AssertLookahead:AssertNegativeLookahead,r.num=void 0,e.groupCounter.i--},groupEnd:function(e,t,a,r,n){var s=(e=y(e))._parentGroup;if(!s)throw new E({type:"UnexpectedChar",lastIndex:a,lastState:r,lastStack:e,message:"Unexpected end parenthesis!"});return delete e._parentGroup,delete e.groupCounter,e=s._parentStack,delete s._parentStack,e.unshift(s),s.endParenIndex=a,e},choice:function(e,t,a){var r,n,s=[];return e._parentChoice?((n=e._parentChoice).branches.unshift(s),p(s,"_parentChoice",n),p(s,"_parentGroup",n),s.groupCounter=e.groupCounter,delete e._parentChoice,delete e.groupCounter):(r=e[e.length-1],p(n={id:Math.random().toString(36).substr(2,9),type:CHOICE_NODE,indices:[r?r.indices[0]:a-1],branches:[]},"_parentStack",e),n.branches.unshift(e.slice()),e.length=0,e.unshift(n),s.groupCounter=e.groupCounter,p(s,"_parentChoice",n),p(s,"_parentGroup",n),n.branches.unshift(s)),s},endChoice:y,charsetStart:function(e,t,a){e.unshift({id:Math.random().toString(36).substr(2,9),type:CHARSET_NODE,indices:[a],classes:[],ranges:[],chars:""})},charsetExclude:function(e){e[0].exclude=!0},charsetContent:function(e,t,a){e[0].chars+=t},charsetNullChar:function(e,t,a){e[0].chars+="\0"},charsetClassEscape:function(e,t){e[0].classes.push(t)},charsetHexEscape:function(e,t,a,r,n){e=e[0],t=String.fromCharCode(parseInt(e.chars.slice(-1)+t,16)),e.chars=e.chars.slice(0,-2),e.chars+=t},charsetUnicodeEscape:function(e,t,a,r,n){e=e[0],t=String.fromCharCode(parseInt(e.chars.slice(-3)+t,16)),e.chars=e.chars.slice(0,-4),e.chars+=t},charsetRangeEnd:C,charsetNormalEscape:function(e,t,a){f.hasOwnProperty(t)&&(t=f[t]),e[0].chars+=t},charsetRangeEndNormalEscape:function(e,t){f.hasOwnProperty(t)&&(t=f[t]),C.apply(this,arguments)},charsetRangeEndUnicodeEscape:function(e,t,a){var r=e[0],n=r.chars.slice(-3)+t;r.chars=r.chars.slice(0,-3),e=r.ranges.pop(),t=String.fromCharCode(parseInt(n,16)),(e=[e[0],t]).lastIndex=a,r.ranges.push(e)},charsetRangeEndHexEscape:function(e,t,a){var r=e[0],n=r.chars.slice(-1)+t;r.chars=r.chars.slice(0,-1),e=r.ranges.pop(),t=String.fromCharCode(parseInt(n,16)),(e=[e[0],t]).lastIndex=a,r.ranges.push(e)}};function m(e,t,a,r,n){var s=e[0],t={min:t,max:a,nonGreedy:!1},a=r-1;s.chars&&1===s.chars.length&&(a=s.indices[0]),s.type===EXACT_NODE?(n={id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,repeat:t,chars:s.chars||n[a],indices:[a]},s.indices[0]===a&&e.shift(),e.unshift(n)):s.repeat=t,p(t,"beginIndex",r-e[0].indices[0])}function y(e){if(e._parentChoice){var t=e._parentChoice;delete e._parentChoice,delete e._parentGroup,delete e.groupCounter;var a=t._parentStack;return delete t._parentStack,a}return e}function C(e,t,a,r,n){var s=e[0];(e=[(e=s.chars.slice(-2))[0],t]).lastIndex=a,s.ranges.push(e),s.chars=s.chars.slice(0,-2)}var S="0-9a-fA-F",w="repeatnStart,repeatn_1,repeatn_2,repeatnErrorStart,repeatnError_1,repeatnError_2",b="hexEscape1,hexEscape2",N="unicodeEscape1,unicodeEscape2,unicodeEscape3,unicodeEscape4",_="charsetUnicodeEscape1,charsetUnicodeEscape2,charsetUnicodeEscape3,charsetUnicodeEscape4,charsetHexEscape1,charsetHexEscape2",k={compact:!0,accepts:"start,begin,end,repeat0,repeat1,exact,repeatn,repeat01,repeatNonGreedy,choice,"+w+",nullChar,digitBackref,"+N+","+b,trans:[["start,begin,end,exact,repeatNonGreedy,repeat0,repeat1,repeat01,groupStart,groupQualifiedStart,choice,repeatn>exact","^+*?^$.|(){[\\",x.exact],["hexEscape1,hexEscape2,unicodeEscape1,unicodeEscape2,unicodeEscape3,unicodeEscape4>exact","^+*?^$.|(){[\\0-9a-fA-F",x.exact],["nullChar>exact","^+*?^$.|(){[\\0-9",x.exact],[w+",nullChar,digitBackref,"+N+","+b+",start,begin,end,exact,repeatNonGreedy,repeat0,repeat1,repeat01,groupStart,groupQualifiedStart,choice,repeatn>exact",".",x.dot],["start,groupStart,groupQualifiedStart,end,begin,exact,repeat0,repeat1,repeat01,repeatn,repeatNonGreedy,choice,"+w+",nullChar,digitBackref,"+N+","+b+">begin","^",x.assertBegin],[w+",nullChar,digitBackref,"+N+","+b+",exact>repeatnStart","{",x.repeatnStart],["start,begin,end,groupQualifiedStart,groupStart,repeat0,repeat1,repeatn,repeat01,repeatNonGreedy,choice>repeatnErrorStart","{",x.exact],["repeatnStart>repeatn_1","0-9",x.exact],["repeatn_1>repeatn_1","0-9",x.exact],["repeatn_1>repeatn_2",",",x.repeatnComma],["repeatn_2>repeatn_2","0-9",x.exact],["repeatn_1,repeatn_2>repeatn","}",x.repeatnEnd],["repeatnStart,repeatnErrorStart>exact","}",x.exact],["repeatnStart,repeatnErrorStart>exact","^+*?^$.|(){[\\0-9}",x.exact],["repeatnErrorStart>repeatnError_1","0-9",x.exact],["repeatnError_1>repeatnError_1","0-9",x.exact],["repeatnError_1>repeatnError_2",",",x.exact],["repeatnError_2>repeatnError_2","0-9",x.exact],["repeatnError_2,repeatnError_1>repeatErrorFinal","}"],["repeatn_1,repeatnError_1>exact","^+*?^$.|(){[\\0-9,}",x.exact],["repeatn_2,repeatnError_2>exact","^+*?^$.|(){[\\0-9}",x.exact],["exact,"+w+",nullChar,digitBackref,"+N+","+b+">repeat0","*",x.repeat0ToInf],["exact,"+w+",nullChar,digitBackref,"+N+","+b+">repeat1","+",x.repeat1ToInf],["exact,"+w+",nullChar,digitBackref,"+N+","+b+">repeat01","?",x.repeat0To1],["choice>repeatErrorFinal","*+?"],["repeat0,repeat1,repeat01,repeatn>repeatNonGreedy","?",x.repeatNonGreedy],["repeat0,repeat1,repeat01,repeatn>repeatErrorFinal","+*"],["start,begin,end,groupStart,groupQualifiedStart,exact,repeatNonGreedy,repeat0,repeat1,repeat01,repeatn,choice,"+w+",nullChar,digitBackref,"+N+","+b+">escape","\\",x.escapeStart],["escape>nullChar","0",x.nullChar],["nullChar>digitFollowNullError","0-9"],["escape>exact","^dDwWsSux0-9bB1-9",x.normalEscape],["escape>exact","bB",x.assertWordBoundary],["escape>exact","dDwWsS",x.charClassEscape],["escape>unicodeEscape1","u",x.exact],["unicodeEscape1>unicodeEscape2",S,x.exact],["unicodeEscape2>unicodeEscape3",S,x.exact],["unicodeEscape3>unicodeEscape4",S,x.exact],["unicodeEscape4>exact",S,x.unicodeEscape],["escape>hexEscape1","x",x.exact],["hexEscape1>hexEscape2",S,x.exact],["hexEscape2>exact",S,x.hexEscape],["escape>digitBackref","1-9",x.backref],["digitBackref>digitBackref","0-9",x.backref],["digitBackref>exact","^+*?^$.|(){[\\0-9",x.exact],["exact,begin,end,repeat0,repeat1,repeat01,repeatn,repeatNonGreedy,start,groupStart,groupQualifiedStart,choice,"+w+",nullChar,digitBackref,"+N+","+b+">groupStart","(",x.groupStart],["groupStart>groupQualify","?"],["groupQualify>groupQualifiedStart",":",x.groupNonCapture],["groupQualify>groupQualifiedStart","=",x.groupToAssertion],["groupQualify>groupQualifiedStart","!",x.groupToAssertion],[w+",nullChar,digitBackref,"+N+","+b+",groupStart,groupQualifiedStart,begin,end,exact,repeat1,repeat0,repeat01,repeatn,repeatNonGreedy,choice>exact",")",x.groupEnd],["start,begin,end,groupStart,groupQualifiedStart,exact,repeat0,repeat1,repeat01,repeatn,repeatNonGreedy,choice,"+w+",nullChar,digitBackref,"+N+","+b+">choice","|",x.choice],["start,groupStart,groupQualifiedStart,begin,exact,repeat0,repeat1,repeat01,repeatn,repeatNonGreedy,choice,"+w+",nullChar,digitBackref,"+N+","+b+">end","$",x.assertEnd],["exact,begin,end,repeat0,repeat1,repeat01,repeatn,repeatNonGreedy,groupQualifiedStart,groupStart,start,choice,"+w+",nullChar,digitBackref,"+N+","+b+">charsetStart","[",x.charsetStart],["charsetStart>charsetExclude","^",x.charsetExclude],["charsetStart>charsetContent","^\\]^",x.charsetContent],["charsetExclude>charsetContent","^\\]",x.charsetContent],["charsetContent,charsetClass>charsetContent","^\\]-",x.charsetContent],["charsetClass>charsetContent","-",x.charsetContent],[_+",charsetStart,charsetContent,charsetNullChar,charsetClass,charsetExclude,charsetRangeEnd>charsetEscape","\\"],["charsetEscape>charsetContent","^dDwWsSux0-9",x.charsetNormalEscape],["charsetEscape>charsetNullChar","0",x.charsetNullChar],["charsetEscape>charsetOctEscape","1-9"],["charsetRangeEndEscape>charsetOctEscape","1-9"],["charsetNullChar>digitFollowNullError","0-9"],["charsetNullChar>charsetContent","^0-9\\]-",x.charsetContent],["charsetEscape>charsetClass","dDwWsS",x.charsetClassEscape],["charsetEscape>charsetUnicodeEscape1","u",x.charsetContent],["charsetUnicodeEscape1>charsetUnicodeEscape2",S,x.charsetContent],["charsetUnicodeEscape2>charsetUnicodeEscape3",S,x.charsetContent],["charsetUnicodeEscape3>charsetUnicodeEscape4",S,x.charsetContent],["charsetUnicodeEscape4>charsetContent",S,x.charsetUnicodeEscape],["charsetEscape>charsetHexEscape1","x",x.charsetContent],["charsetHexEscape1>charsetHexEscape2",S,x.charsetContent],["charsetHexEscape2>charsetContent",S,x.charsetHexEscape],[_+">charsetContent","^\\]0-9a-fA-F-",x.charsetContent],[_+",charsetNullChar,charsetContent>charsetRangeStart","-",x.charsetContent],["charsetRangeStart>charsetRangeEnd","^\\]",x.charsetRangeEnd],["charsetRangeEnd>charsetContent","^\\]",x.charsetContent],["charsetRangeStart>charsetRangeEndEscape","\\"],["charsetRangeEndEscape>charsetRangeEnd","^dDwWsSux0-9bB1-9",x.charsetRangeEndNormalEscape],["charsetRangeEndEscape>charsetRangeEndWithNullChar","0"],["charsetRangeEndEscape>charsetRangeEndUnicodeEscape1","u",x.charsetRangeEnd],["charsetRangeEndUnicodeEscape1>charsetRangeEndUnicodeEscape2",S,x.charsetContent],["charsetRangeEndUnicodeEscape2>charsetRangeEndUnicodeEscape3",S,x.charsetContent],["charsetRangeEndUnicodeEscape3>charsetRangeEndUnicodeEscape4",S,x.charsetContent],["charsetRangeEndUnicodeEscape4>charsetRangeEnd",S,x.charsetRangeEndUnicodeEscape],["charsetRangeEndEscape>charsetRangeEndHexEscape1","x",x.charsetRangeEnd],["charsetRangeEndHexEscape1>charsetRangeEndHexEscape2",S,x.charsetContent],["charsetRangeEndHexEscape2>charsetRangeEnd",S,x.charsetRangeEndHexEscape],["charsetRangeEndEscape>charsetRangeEndClass","dDwWsS"],["charsetRangeEndUnicodeEscape1,charsetRangeEndHexEscape1>charsetContent","^\\]0-9a-fA-F",x.charsetContent],["charsetRangeEndUnicodeEscape2,charsetRangeEndUnicodeEscape3,charsetRangeEndUnicodeEscape4,charsetRangeEndHexEscape2>charsetRangeStart","-",x.charsetContent],[_+",charsetRangeEndUnicodeEscape1,charsetRangeEndHexEscape1,charsetRangeEndUnicodeEscape2,charsetRangeEndUnicodeEscape3,charsetRangeEndUnicodeEscape4,charsetRangeEndHexEscape2,charsetNullChar,charsetRangeStart,charsetContent,charsetClass,charsetExclude,charsetRangeEnd>exact","]"],["groupQualify>groupNamedDefined","P"],["groupNamedDefined>groupNamedStart","<"],["groupNamedStart,groupNamedContent>groupNamedContent","0-9a-zA-Z_",x.groupNamedContent],["groupNamedContent>groupNamedEnd","0-9a-zA-Z_",x.groupNamedContent],["groupNamedEnd,groupNamedContent>groupQualifiedStart",">"]]};return o}function visualize(e,t,a){var h,o=Kit();function p(e,t){if(t=t||"normal",n[e]&&n[e][t])return n[e][t];h.attr({"font-size":e,"font-weight":t});var a=h.getBBox();return n[e]=n[e]||{},n[e][t]={width:a.width/((h.attr("text").length-1)/2),height:a.height/2}}function C(e,t,a){e.forEach(function(e){e._translate?e._translate(t,a):(e.x+=t,e.y+=a)})}function l(a,e,r){var t,n=[],s=[],i=0,c=e,o=r,h=r;if(!a.length)return N.empty(a,e,r);a.forEach(function(e){e=e.repeat?N.repeat(e,c,r):N[e.type](e,c,r),n.push(e),c+=e.width+16,i+=e.width,o=Math.min(o,e.y),h=Math.max(h,e.y+e.height),s=s.concat(e.items)}),t=h-o,n.reduce(function(e,t){return i+=16,e=g(a,e.lineOutX,r,t.lineInX,_fromItem=e,_toItem=t),s.push(e),t});var p=n[0].lineInX,u=n[n.length-1].lineOutX;return{items:s,width:i,height:t,x:e,y:o,lineInX:p,lineOutX:u}}function S(e,t,a,r,n,s){t=o.toPrint(t);var i=p(m),c=t.length*i.width,i=i.height+12,c=12+c,n={type:"rect",class:`rect:${e.type}:${e.indices.join(";")}`,x:a,y:r-i/2,width:c,height:i,stroke:"none",fill:n||"transparent"};return{text:s={type:"text",class:`text:${e.type}:${e.indices.join(";")}`,x:a+c/2,y:r,text:t,"font-size":m,"font-family":f,fill:s||"black"},rect:n,items:[n,s],width:c,height:i,x:a,y:n.y,lineInX:a,lineOutX:a+c}}function w(e,t,a,r,n){var s=p(14),i=(c=r.split("\n")).length*s.height,c=1<c.length?Math.max.apply(Math,c.map(function(e){return e.length})):r.length;return c*=s.width,{label:{type:"text",class:`text:${e.type}:${e.indices.join(";")}`,x:t,y:a-i/2-4,text:r,"font-size":14,"font-family":f,fill:n||"#444"},x:t-c/2,y:a-i-4,width:c,height:4+i}}function g(e,t,a,r,n=null,s=null){let i="linejoint";return null!==n&&(i=`${i}::${n.items.map(e=>e.class).join("_")}`),null!==s&&(i=`${i}::${s.items.map(e=>e.class).join("_")}::`),e.hasOwnProperty("indices")&&(i=`curve:${e.indices.join(";")}`),{type:"path",class:`path:${i}`,x:t,y:a,path:["M",t,a,"H",r],"stroke-linecap":"butt","stroke-linejoin":"round",stroke:"#333","stroke-width":2,_translate:function(e,t){var a=this.path;a[1]+=e,a[2]+=t,a[4]+=e}}}function E(e,t,a,r,n){var s,i=r<t?-1:1,c=n<a?-1:1,r=Math.abs(a-n)<15?(s=["M",t,a,"C",t+Math.min(Math.abs(r-t)/2,10)*i,a,r-(r-t)/2,n,r,n],function(e,t){var a=this.path;a[1]+=e,a[2]+=t,a[4]+=e,a[5]+=t,a[6]+=e,a[7]+=t,a[8]+=e,a[9]+=t}):(s=["M",t,a,"Q",t+10*i,a,t+10*i,a+10*c,"V",Math.abs(a-n)<20?a+10*c:n-10*c,"Q",t+10*i,n,t+10*i*2,n,"H",r],function(e,t){var a=this.path;a[1]+=e,a[2]+=t,a[4]+=e,a[5]+=t,a[6]+=e,a[7]+=t,a[9]+=t,a[11]+=e,a[12]+=t,a[13]+=e,a[14]+=t,a[16]+=e});return{type:"path",class:`path:curve:${e.indices.join(";")}`,path:s,"stroke-linecap":"butt","stroke-linejoin":"round",stroke:"#333","stroke-width":2,_translate:r}}function r(e,t,a,r){return{items:[{type:"circle",class:`circle:${e.type}:${e.indices.join(";")}`,fill:r,cx:t+10,cy:a,r:10,stroke:"none",_translate:function(e,t){this.cx+=e,this.cy+=t}}],width:20,height:20,x:t,y:a,lineInX:t,lineOutX:t+20}}function x(e){if(Array.isArray(e)){for(var t=e,a=0;a<t.length;a++)if(!x(t[a]))return!1;return!0}return e.type===EMPTY_NODE||(e.type===GROUP_NODE&&void 0===e.num?x(e.sub):e.type===CHOICE_NODE?x(e.branches):void 0)}function u(e){var n=[];return e.forEach(function(e){var t,a,r;e.sub?(n.push(d("(")),e.type===ASSERT_NODE?e.assertionType===AssertLookahead?n.push(d("?=")):n.push(d("?!")):""!==e.name?n.push(d(`?P<${e.name}>`)):e.nonCapture&&n.push(d("?:")),(n=n.concat(u(e.sub))).push(d(")"))):e.branches?(e.branches.map(u).forEach(function(e){(n=n.concat(e)).push(d("|"))}),n.pop()):(r=_[e.type]||_.defaults,e.type===CHARSET_NODE?((t=b(e))&&!e.exclude||n.push(d("[")),e.exclude&&n.push(d("^",_.charsetExclude)),e.ranges.forEach(function(e){n.push(d(s(e[0]+"-"+e[1]),_.charsetRange))}),e.classes.forEach(function(e){n.push(d("\\"+e,_.charsetClass))}),n.push(d(s(e.chars),_.charsetChars)),t&&!e.exclude||n.push(d("]"))):(a=e.raw||"",e.repeat&&(a=a.slice(0,e.repeat.beginIndex)),a=o.toPrint(a,!0),n.push(d(a,r)))),e.repeat&&(a=e.repeat.min,r=e.repeat.max,0===a&&r===1/0?n.push(d("*")):1===a&&r===1/0?n.push(d("+")):0===a&&1===r?n.push(d("?")):(n.push(d("{")),n.push(d(a)),a===r||(n.push(d(",")),isFinite(r)&&n.push(d(r))),n.push(d("}"))),e.repeat.nonGreedy&&n.push(d("?",_.repeatNonGreedy)))}),n}function s(e){return(e=o.toPrint(e)).replace(/\[/g,"\\[").replace(/\]/g,"\\]")}function d(e,t){return t=t||_[e]||_.defaults,{type:"text","font-size":m,"font-family":f,text:e+"",fill:t,"text-anchor":"start","font-weight":"bold"}}function b(e){return!e.chars&&!e.ranges.length&&1===e.classes.length}var f="DejaVu Sans Mono,monospace",m=16,y=!1,n={},N={startPoint:function(e,t,a){return r({type:"startPoint",indices:[-1,-1]},t,a,"r(0.5,0.5)#EFE-green")},endPoint:function(e,t,a){return r({type:"endPoint",indices:[1/0,1/0]},t,a,"r(0.5,0.5)#FFF-#000")},empty:function(e,t,a){return{items:[g(e,t,a,t+10)],width:10,height:2,x:t,y:a,lineInX:t,lineOutX:t+10}},exact:function(e,t,a){return S(e,e.chars,t,a,"skyblue")},dot:function(e,t,a){return(a=S(e,"AnyCharExceptNewLine",t,a,"DarkGreen","white")).rect.r=10,a.rect.tip="AnyChar except CR LF",a},backref:function(e,t,a){return(a=S(regexJSONInfom,"Backref #"+e.num,t,a,"navy","white")).rect.r=8,a},repeat:function(e,t,a){function r(e){return e+(e<2?" time":" times")}function n(e,t){var a=this.path;a[1]+=e,a[2]+=t,a[4]+=e,a[5]+=t,a[6]+=e,a[7]+=t,a[9]+=t,a[11]+=e,a[12]+=t,a[13]+=e,a[14]+=t,a[16]+=e,a[18]+=e,a[19]+=t,a[20]+=e,a[21]+=t,a[23]+=t,a[25]+=e,a[26]+=t,a[27]+=e,a[28]+=t}if(x(e))return N.empty(e,t,a);var s=e.repeat,i="",c=[];if(s.min===s.max&&0===s.min)return N.empty(e,t,a);var o=N[e.type](e,t,a),h=o.width,p=o.height;if(s.min===s.max&&1===s.min)return o;s.min===s.max?i+=r(s.min):(i+=s.min,isFinite(s.max)?i+=(1<s.max-s.min?" to ":" or ")+r(s.max):i+=" or more times");var u,d,l=10,g=0,E=o.y+o.height-a,f=20+o.width,h=f;return 1!==s.max?(E+=10,p+=10,u={type:"path",class:`path:curve:${e.indices.join(";")}`,path:["M",o.x+10,a,"Q",t,a,t,a+10,"V",a+E-10,"Q",t,a+E,t+10,a+E,"H",t+f-10,"Q",t+f,a+E,t+f,a+E-10,"V",a+10,"Q",t+f,a,o.x+o.width+10,a],_translate:n,stroke:"maroon","stroke-width":2},s.nonGreedy&&(u.stroke="Brown",u["stroke-dasharray"]="-"),c.push(u)):i=!1,0===s.min&&(d=a-o.y+10,l+=10,g=-12,h=f+=20,p+=10,s={type:"path",class:`path:curve:${e.indices.join(";")}`,path:["M",t,a,"Q",t+10,a,t+10,a-10,"V",a-d+10,"Q",t+10,a-d,t+20,a-d,"H",t+f-20,"Q",t+f-10,a-d,t+f-10,a-d+10,"V",a-10,"Q",t+f-10,a,t+f,a],_translate:n,stroke:s.nonGreedy?"darkgreen":"#333","stroke-width":2},u&&C([u],10,0),c.push(s)),i&&(C([(i=w(e,t+h/2,a,i)).label],0,E+i.height+4),c.push(i.label),p+=4+i.height,(E=(Math.max(i.width,h)-h)/2)&&C(c,E,0),h=Math.max(i.width,h),l+=E),C(o.items,l,0),{items:c=c.concat(o.items),width:h,height:p,x:t,y:o.y+g,lineInX:o.lineInX+l,lineOutX:o.lineOutX+l}},choice:function(s,i,c){if(x(s))return N.empty(s,i,c);var t=0,o=0,e=s.branches.map(function(e){return e=l(e,i,c),t+=e.height,o=Math.max(o,e.width),e});t+=6*(e.length-1)+8;var h=i+(o+=40)/2,p=c-t/2+4,u=i+o,d=[];return e.forEach(function(e){var t=h-e.width/2;C(e.items,t-e.x,p-e.y),d=d.concat(e.items);var a=c+p-e.y,r=E(s,i,c,i+20,a),n=E(s,u,c,i+o-20,a);d.push(r,n),i+20!==t-e.x+e.lineInX&&d.push(g(s,i+20,a,t-e.x+e.lineInX)),e.lineOutX+t-e.x!=i+o-20&&d.push(g(s,e.lineOutX+t-e.x,a,i+o-20)),e.x=t,e.y=p,p+=e.height+6}),{items:d,width:o,height:t,x:i,y:c-t/2,lineInX:i,lineOutX:u}},charset:function(t,a,r){var e,n={d:"Digit",D:"NonDigit",w:"Word",W:"NonWord",s:"WhiteSpace",S:"NonWhiteSpace"},s=t.exclude?"Pink":"Khaki",i=t.exclude?"#C00":"";if(b(t)){if((e=S(t,n[t.classes[0]],a,r,"Green","white")).rect.r=5,t.exclude){var c=w(t,e.x+e.width/2,e.y,"None of:",i);(m=e.items).push(c.label);var o=e.width,h=Math.max(c.width,e.width);return C(m,y=(h-o)/2,0),{items:m,width:h,height:e.height+c.height,x:Math.min(c.x,e.x),y:c.y,lineInX:y+e.x,lineOutX:y+e.x+e.width}}return e}if(!t.chars&&!t.ranges.length&&!t.classes.length)return(e=S(t,"AnyChar",a,r,"green","white")).rect.r=5,e;var p=[],h=0,u=0;t.chars&&((g=S(t,t.chars,a,r,"LightSkyBlue","black")).rect.r=5,p.push(g),h=g.width),t.ranges.forEach(function(e){e=e.split("").join("-"),(e=S(t,e,a,r,"teal","white")).rect.r=5,p.push(e),h=Math.max(e.width,h)}),t.classes.forEach(function(e){(e=S(t,n[e],a,r,"Green","white")).rect.r=5,p.push(e),h=Math.max(e.width,h)});var d,l,g=p[0].height,E=[],f=[];for(p.sort(function(e,t){return t.width-e.width}),p.forEach(function(e){(2*e.width+4>h?E:f).push(e)}),p=E;f.length;){if(d=f.pop(),!(l=f.pop())){p.push(d);break}2<d.width-l.width?(p.push(d),f.push(l)):(C(l.items,d.width+4,0),p.push({items:d.items.concat(l.items),width:d.width+l.width+4,height:d.height,x:d.x,y:d.y}),u-=d.height)}h+=12;var u=4*(p.length-1)+p.length*g+12,x=(s={type:"rect",class:`rect:charsetgroup:${t.indices.join(";")}`,x:a,y:r-u/2,r:4,width:h,height:u,stroke:"none",fill:s}).y+6,m=[s];p.forEach(function(e){C(e.items,a-e.x+(h-e.width)/2,x-e.y),m=m.concat(e.items),x+=e.height+4}),c=w({type:"charsetgroup",indices:t.indices},s.x+s.width/2,s.y,(t.exclude?"None":"One")+" of:",i),m.push(c.label);var y,o=h;return h=Math.max(c.width,h),C(m,y=(h-o)/2,0),{items:m,width:h,height:u+c.height,x:Math.min(c.x,a),y:c.y,lineInX:y+a,lineOutX:y+a+s.width}},group:function(e,t,a){if(x(e))return N.empty(e,t,a);var r=l(e.sub,0,0),n={type:"group",class:`g:${e.type}:${[e.indices[0]+1,e.indices[1]-1].join(";")}:t${r.x},${r.y}`,subs:r.items,transform:`t${r.x},${r.y}`,x:r.x,y:r.y,width:r.width,height:r.height};if(e.num){C(r.items,10,0);var s=r.width+20,i=r.height+20,c={type:"rect",class:`rect:${e.type}:${e.indices.join(";")}`,x:t,y:r.y-10,r:6,width:s,height:i,"stroke-dasharray":".",stroke:"silver","stroke-width":2},o=w(e,c.x+c.width/2,c.y-2,`Group ${e.name}#${e.num}`),h=Math.max(o.width,s),s=(h-s)/2,i={type:"group",class:`g:${e.type}:${e.indices.join(";")}`,subs:[n,c,o.label],transform:`t${t+s},${a}`,x:t+s,y:a,width:h,height:i+o.height+4},o=r.items.concat([c,o.label]);return s&&C(o,s,0),{items:[i],width:i.width,height:i.height,x:t+s,y:a,lineInX:s+r.lineInX+10,lineOutX:s+r.lineOutX+10}}return{items:[n],width:n.width,height:n.height,x:r.x,y:r.y,lineInX:r.lineInX,lineOutX:r.lineOutX}},assert:function(e,t,a){var r=(s=e.assertionType).replace("Assert","")+"!";if(n={AssertNonWordBoundary:{bg:"maroon",fg:"white"},AssertWordBoundary:{bg:"purple",fg:"white"},AssertEnd:{bg:"Indigo",fg:"white"},AssertBegin:{bg:"Indigo",fg:"white"}}[s])return S(e,r=!y||"AssertBegin"!==s&&"AssertEnd"!==s?r:"Line"+r,t,a,n.bg,n.fg);s===AssertLookahead?(i="CornflowerBlue",c="darkgreen",r="Followed by:"):s===AssertNegativeLookahead&&(i="#F63",c="Purple",r="Not followed by:");var n=N.group(e,t,a),s=n.height+16,a=n.width+16,i={type:"rect",class:`rect:${e.type}:${e.indices.join(";")}`,x:t,y:n.y-8,r:6,width:a,height:s,"stroke-dasharray":"-",stroke:i,"stroke-width":2},r=w(e,i.x+a/2,i.y,r,c),c=Math.max(a,r.width),a=(c-a)/2;return C(n.items,8+a,0),a&&C([i,r.label],a,0),{items:n.items.concat([i,r.label]),width:c,height:i.height+r.height,x:t,y:r.y,lineInX:a+n.lineInX+8,lineOutX:a+n.lineOutX+8}}},_={delimiter:"Indigo",flags:"darkgreen",exact:"#334",dot:"darkblue",backref:"teal",$:"purple","^":"purple","\\b":"#F30","\\B":"#F30","(":"blue",")":"blue","?=":"darkgreen","?!":"red","?:":"grey","[":"navy","]":"navy","|":"blue","{":"maroon",",":"maroon","}":"maroon","*":"maroon","+":"maroon","?":"maroon",repeatNonGreedy:"#F61",defaults:"black",charsetRange:"olive",charsetClass:"navy",charsetExclude:"red",charsetChars:"#534"};return function(e,t,a){a.clear(),a.setSize(0,0);var r,n=a.rect(0,0,0,0);n.attr("fill","#EEE"),n.attr("stroke","#EEE"),h=a.text(-1e3,-1e3,"XgfTlM|.q\nXgfTlM|.q").attr({"font-family":f,"font-size":m}),y=!!~t.indexOf("m"),(r=u(e.tree)).unshift(d("/",_.delimiter)),r.unshift(d("RegExp: ")),r.push(d("/",_.delimiter)),t&&r.push(d(t,_.flags));var s=p(m,"bold"),i=s.height/2+10,c=r.reduce(function(e,t){return t.x=e,t.y=i,e+t.text.length*s.width},10);c+=10,o=s.height+20,r=a.add(r),a.setSize(c,s.height+20);var e=(r=0,(t=e.tree).unshift({type:"startPoint"}),t.push({type:"endPoint"}),l(t,r,0)),o=Math.max(e.height+30+s.height,o),c=Math.max(e.width+20,c);a.setSize(c,o),n.attr("width",c),n.attr("height",o),C(e.items,10,20+s.height-e.y),a.addv2(e.items)}(e,t,a)}