function parse(e,t){var a,c,r,n=Kit();function s(){var e=Object.keys(a).map(function(e){return e+"="+JSON.stringify(a[e])}).join(";");!function(){return this}().eval(e)}function i(e){this.raw=e.raw,this.tree=e.tree,this.groupCount=e.groupCount}function o(e,t){c=t;var a,r=h().input(e,0,t),n=r.stack,n=x.endChoice(n),s=r.lastState;if(!(t=r.acceptable&&r.lastIndex===e.length-1)){switch(s){case"charsetRangeEndWithNullChar":a={type:"CharsetRangeEndWithNullChar",message:"Charset range end with NUL char does not make sense!\nBecause [a-\\0] is not a valid range.\nAnd [\\0-\\0] should be rewritten into [\\0]."};break;case"repeatErrorFinal":a={type:"NothingRepeat",message:"Nothing to repeat!"};break;case"digitFollowNullError":a={type:"DigitFollowNullError",message:"The '\\0' represents the <NUL> char and cannot be followed by a decimal digit!"};break;case"charsetRangeEndClass":a={type:"CharsetRangeEndClass",message:'Charset range ends with class such as "\\w\\W\\d\\D\\s\\S" is invalid!'};break;case"charsetOctEscape":a={type:"DecimalEscape",message:"Decimal escape appears in charset is invalid.Because it can't be explained as  backreference.And octal escape is deprecated!"};break;default:0===s.indexOf("charset")?a={type:"UnclosedCharset",message:"Unterminated character class!"}:")"===e[r.lastIndex]?a={type:"UnmatchedParen",message:"Unmatched end parenthesis!"}:(a={type:"UnexpectedChar",message:"Unexpected char!"},r.lastIndex++)}if(a)throw a.lastIndex=r.lastIndex,a.lastStack=r.stack,a.lastState=s,new E(a)}if(n._parentGroup)throw new E({type:"UnterminatedGroup",message:"Unterminated group!",lastIndex:n._parentGroup.indices[0],lastState:s,lastStack:n});if(t)return t=n.groupCounter?n.groupCounter.i:0,delete n.groupCounter,function a(e,r,t){e.length?(e.reduce(function(e,t){return t.indices.push(e),t.raw=r.slice(t.indices[0],e),t.type===GROUP_NODE||t.type===ASSERT_NODE&&t.sub?a(t.sub,r,t.endParenIndex):t.type===CHOICE_NODE?(t.branches.reduce(function(e,t){return a(t,r,e),((t=t[0])?t.indices[0]:e)-1},e),t.branches.reverse()):t.type!==EXACT_NODE||t.concatTemp||(t.chars=t.chars||t.raw),t.indices[0]},t),e.reverse()):e.push({type:EMPTY_NODE,indices:[t,t]})}(n,e,e.length),(t=new i({raw:e,groupCount:t,tree:n=u(n)})).traverse(g,CHARSET_NODE),t.traverse(l,ASSERT_NODE),d(n),c=!1,t}function h(){return r=r||new NFA(k)}function p(e,t,a){Object.defineProperty(e,t,{value:a,enumerable:c,writable:!0,configurable:!0})}function u(e){return e.filter(function(e){return e.type==EXACT_NODE&&e.concatTemp?(delete e.concatTemp,!!e.chars):(e.sub?e.sub=u(e.sub):e.branches&&(e.branches=e.branches.map(u)),!0)})}function d(e){function t(e){e.sub?d(e.sub):e.branches&&e.branches.map(d)}var a=e[0];t(a);for(var r,n=1,s=1,c=e.length;n<c;n++){if((r=e[n]).type===EXACT_NODE){if(a.type===EXACT_NODE&&!a.repeat&&!r.repeat){a.indices[1]=r.indices[1],a.raw+=r.raw,a.chars+=r.chars;continue}}else t(r);a=e[s++]=r}a&&(e.length=s)}function l(e){var t,a;if(e.repeat)throw a="Nothing to repeat! Repeat after assertion doesn't make sense!","AssertLookahead"!==(t=e.assertionType)&&"AssertNegativeLookahead"!==t||(a+="\n/a"+(t="("+("AssertLookahead"===t?"?=":"?!")+"b)")+"+/、/a"+t+"{1,n}/ are the same as /a"+t+"/。\n/a"+t+"*/、/a"+t+"{0,n}/、/a"+t+"?/ are the same as /a/。"),new E({type:"NothingRepeat",lastIndex:e.indices[1]-1,message:a})}function g(e){e.ranges=n.sortUnique(e.ranges.map(function(e){if(e[0]>e[1])throw new E({type:"OutOfOrder",lastIndex:e.lastIndex,message:"Range ["+e.join("-")+"] out of order in character class!"});return e.join("")}))}function E(e){this.name="RegexSyntaxError",this.type=e.type,this.lastIndex=e.lastIndex,this.lastState=e.lastState,this.lastStack=e.lastStack,this.message=e.message,Object.defineProperty(this,"stack",{value:new Error(e.message).stack,enumerable:!1})}a={EXACT_NODE:"exact",CHARSET_NODE:"charset",CHOICE_NODE:"choice",GROUP_NODE:"group",ASSERT_NODE:"assert",DOT_NODE:"dot",BACKREF_NODE:"backref",EMPTY_NODE:"empty",AssertLookahead:"AssertLookahead",AssertNegativeLookahead:"AssertNegativeLookahead",AssertNonWordBoundary:"AssertNonWordBoundary",AssertWordBoundary:"AssertWordBoundary",AssertEnd:"AssertEnd",AssertBegin:"AssertBegin"},s(),i.prototype.traverse=function(e,r){!function t(e,a){e.forEach(function(e){r&&e.type!==r||a(e),e.sub?t(e.sub,a):e.branches&&e.branches.forEach(function(e){t(e,a)})})}(this.tree,e)},o.Constants=a,o.exportConstants=s,o.RegexSyntaxError=E,o.getNFAParser=h,E.prototype.toString=function(){return this.name+" "+this.type+":"+this.message};var f={n:"\n",r:"\r",t:"\t",v:"\v",f:"\f"},x={escapeStart:function(e,t,a){e.unshift({concatTemp:!0,id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,chars:"",indices:[a]})},exact:function(e,t,a){var r=e[0];(!r||r.type!=EXACT_NODE||r.repeat||r.chars&&!r.concatTemp)&&e.unshift({id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,indices:[a]}),r&&r.concatTemp&&(r.chars+=t)},dot:function(e,t,a){e.unshift({id:Math.random().toString(36).substr(2,9),type:DOT_NODE,indices:[a]})},nullChar:function(e,t,a){e.unshift({id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,chars:"\0",indices:[a-1]})},assertBegin:function(e,t,a){e.unshift({id:Math.random().toString(36).substr(2,9),type:ASSERT_NODE,indices:[a],assertionType:AssertBegin})},assertEnd:function(e,t,a,r,n){e.unshift({id:Math.random().toString(36).substr(2,9),type:ASSERT_NODE,indices:[a],assertionType:AssertEnd})},assertWordBoundary:function(e,t,a){e.unshift({id:Math.random().toString(36).substr(2,9),type:ASSERT_NODE,indices:[a-1],assertionType:"b"==t?AssertWordBoundary:AssertNonWordBoundary})},repeatnStart:function(e,t,a){e[0].type!==EXACT_NODE&&e.unshift({id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,indices:[a]})},repeatnComma:function(e,t,a){p(e[0],"_commaIndex",a)},repeatNonGreedy:function(e){e[0].repeat.nonGreedy=!0},repeatnEnd:function(e,t,a,r,n){var s,c=e[0],i=n.lastIndexOf("{",a),o=parseInt(n.slice(i+1,c._commaIndex||a),10);if(c._commaIndex){if((s=c._commaIndex+1==a?1/0:parseInt(n.slice(c._commaIndex+1,a),10))<o)throw new E({type:"OutOfOrder",lastState:r,lastIndex:a,lastStack:e,message:"Numbers out of order in {} quantifier!"});delete c._commaIndex}else s=o;c.indices[0]>=i&&e.shift(),m(e,o,s,i,n)},repeat1ToInf:function(e,t,a,r,n){m(e,1,1/0,a,n)},repeat0To1:function(e,t,a,r,n){m(e,0,1,a,n)},repeat0ToInf:function(e,t,a,r,n){m(e,0,1/0,a,n)},charClassEscape:function(e,t,a){e.unshift({id:Math.random().toString(36).substr(2,9),type:CHARSET_NODE,indices:[a-1],chars:"",ranges:[],classes:[t],exclude:!1})},normalEscape:function(e,t,a){f.hasOwnProperty(t)&&(t=f[t]),e.unshift({id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,chars:t,indices:[a-1]})},unicodeEscape:function(e,t,a,r,n){t=String.fromCharCode(parseInt(n.slice(a-3,a+1),16)),e.shift(),e.unshift({id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,chars:t,indices:[a-5]})},hexEscape:function(e,t,a,r,n){t=String.fromCharCode(parseInt(n[a-1]+t,16)),e.shift(),e.unshift({id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,chars:t,indices:[a-3]})},groupStart:function(e,t,a){var r=e.groupCounter=e.groupCounter||{i:0};return r.i++,p(e=(a={id:Math.random().toString(36).substr(2,9),type:GROUP_NODE,name:"",num:r.i,sub:[],indices:[a],_parentStack:e}).sub,"_parentGroup",a),e.groupCounter=r,e},groupNonCapture:function(e){var t=e._parentGroup;t.nonCapture=!0,t.num=void 0,e.groupCounter.i--},groupNamedContent:function(e,t){e._parentGroup.name+=t},backref:function(e,t,a,r){var n=e[0],s=parseInt(t,10),t=(t=e.groupCounter)&&t.i||0;if("escape"===r?(n={id:Math.random().toString(36).substr(2,9),type:BACKREF_NODE,indices:[a-1]},e.unshift(n)):s=parseInt(n.num+""+s,10),t<s)throw new E({type:"InvalidBackReference",lastIndex:a,lastStack:e,lastState:r,message:"Back reference number("+s+") greater than current groups count("+t+")."});if(function e(t,a){return!!a._parentGroup&&(a._parentGroup.num==t?t:e(t,a._parentGroup._parentStack))}(s,e))throw new E({type:"InvalidBackReference",lastIndex:a,lastStack:e,lastState:r,message:"Recursive back reference in group ("+s+") itself."});n.num=s},groupToAssertion:function(e,t,a){var r=e._parentGroup;r.type=ASSERT_NODE,r.assertionType="="==t?AssertLookahead:AssertNegativeLookahead,r.num=void 0,e.groupCounter.i--},groupEnd:function(e,t,a,r,n){var s=(e=y(e))._parentGroup;if(s)return delete e._parentGroup,delete e.groupCounter,e=s._parentStack,delete s._parentStack,e.unshift(s),s.endParenIndex=a,e;throw new E({type:"UnexpectedChar",lastIndex:a,lastState:r,lastStack:e,message:"Unexpected end parenthesis!"})},choice:function(e,t,a){var r,n,s=[];return e._parentChoice?((n=e._parentChoice).branches.unshift(s),p(s,"_parentChoice",n),p(s,"_parentGroup",n),s.groupCounter=e.groupCounter,delete e._parentChoice,delete e.groupCounter):(r=e[e.length-1],p(n={id:Math.random().toString(36).substr(2,9),type:CHOICE_NODE,indices:[r?r.indices[0]:a-1],branches:[]},"_parentStack",e),n.branches.unshift(e.slice()),e.length=0,e.unshift(n),s.groupCounter=e.groupCounter,p(s,"_parentChoice",n),p(s,"_parentGroup",n),n.branches.unshift(s)),s},endChoice:y,charsetStart:function(e,t,a){e.unshift({id:Math.random().toString(36).substr(2,9),type:CHARSET_NODE,indices:[a],classes:[],ranges:[],chars:""})},charsetExclude:function(e){e[0].exclude=!0},charsetContent:function(e,t,a){e[0].chars+=t},charsetNullChar:function(e,t,a){e[0].chars+="\0"},charsetClassEscape:function(e,t){e[0].classes.push(t)},charsetHexEscape:function(e,t,a,r,n){e=e[0],t=String.fromCharCode(parseInt(e.chars.slice(-1)+t,16)),e.chars=e.chars.slice(0,-2),e.chars+=t},charsetUnicodeEscape:function(e,t,a,r,n){e=e[0],t=String.fromCharCode(parseInt(e.chars.slice(-3)+t,16)),e.chars=e.chars.slice(0,-4),e.chars+=t},charsetRangeEnd:C,charsetNormalEscape:function(e,t,a){f.hasOwnProperty(t)&&(t=f[t]),e[0].chars+=t},charsetRangeEndNormalEscape:function(e,t){f.hasOwnProperty(t)&&(t=f[t]),C.apply(this,arguments)},charsetRangeEndUnicodeEscape:function(e,t,a){var r=e[0],n=r.chars.slice(-3)+t;r.chars=r.chars.slice(0,-3),e=r.ranges.pop(),t=String.fromCharCode(parseInt(n,16)),(e=[e[0],t]).lastIndex=a,r.ranges.push(e)},charsetRangeEndHexEscape:function(e,t,a){var r=e[0],n=r.chars.slice(-1)+t;r.chars=r.chars.slice(0,-1),e=r.ranges.pop(),t=String.fromCharCode(parseInt(n,16)),(e=[e[0],t]).lastIndex=a,r.ranges.push(e)}};function m(e,t,a,r,n){var s=e[0],t={min:t,max:a,nonGreedy:!1},a=r-1;s.chars&&1===s.chars.length&&(a=s.indices[0]),s.type===EXACT_NODE?(n={id:Math.random().toString(36).substr(2,9),type:EXACT_NODE,repeat:t,chars:s.chars||n[a],indices:[a]},s.indices[0]===a&&e.shift(),e.unshift(n)):s.repeat=t,p(t,"beginIndex",r-e[0].indices[0])}function y(e){var t,a;return e._parentChoice?(t=e._parentChoice,delete e._parentChoice,delete e._parentGroup,delete e.groupCounter,a=t._parentStack,delete t._parentStack,a):e}function C(e,t,a,r,n){var s=e[0];(e=[(e=s.chars.slice(-2))[0],t]).lastIndex=a,s.ranges.push(e),s.chars=s.chars.slice(0,-2)}var S="0-9a-fA-F",w="repeatnStart,repeatn_1,repeatn_2,repeatnErrorStart,repeatnError_1,repeatnError_2",b="hexEscape1,hexEscape2",N="unicodeEscape1,unicodeEscape2,unicodeEscape3,unicodeEscape4",_="charsetUnicodeEscape1,charsetUnicodeEscape2,charsetUnicodeEscape3,charsetUnicodeEscape4,charsetHexEscape1,charsetHexEscape2",k={compact:!0,accepts:"start,begin,end,repeat0,repeat1,exact,repeatn,repeat01,repeatNonGreedy,choice,"+w+",nullChar,digitBackref,"+N+","+b,trans:[["start,begin,end,exact,repeatNonGreedy,repeat0,repeat1,repeat01,groupStart,groupQualifiedStart,choice,repeatn>exact","^+*?^$.|(){[\\",x.exact],["hexEscape1,hexEscape2,unicodeEscape1,unicodeEscape2,unicodeEscape3,unicodeEscape4>exact","^+*?^$.|(){[\\0-9a-fA-F",x.exact],["nullChar>exact","^+*?^$.|(){[\\0-9",x.exact],[w+",nullChar,digitBackref,"+N+","+b+",start,begin,end,exact,repeatNonGreedy,repeat0,repeat1,repeat01,groupStart,groupQualifiedStart,choice,repeatn>exact",".",x.dot],["start,groupStart,groupQualifiedStart,end,begin,exact,repeat0,repeat1,repeat01,repeatn,repeatNonGreedy,choice,"+w+",nullChar,digitBackref,"+N+","+b+">begin","^",x.assertBegin],[w+",nullChar,digitBackref,"+N+","+b+",exact>repeatnStart","{",x.repeatnStart],["start,begin,end,groupQualifiedStart,groupStart,repeat0,repeat1,repeatn,repeat01,repeatNonGreedy,choice>repeatnErrorStart","{",x.exact],["repeatnStart>repeatn_1","0-9",x.exact],["repeatn_1>repeatn_1","0-9",x.exact],["repeatn_1>repeatn_2",",",x.repeatnComma],["repeatn_2>repeatn_2","0-9",x.exact],["repeatn_1,repeatn_2>repeatn","}",x.repeatnEnd],["repeatnStart,repeatnErrorStart>exact","}",x.exact],["repeatnStart,repeatnErrorStart>exact","^+*?^$.|(){[\\0-9}",x.exact],["repeatnErrorStart>repeatnError_1","0-9",x.exact],["repeatnError_1>repeatnError_1","0-9",x.exact],["repeatnError_1>repeatnError_2",",",x.exact],["repeatnError_2>repeatnError_2","0-9",x.exact],["repeatnError_2,repeatnError_1>repeatErrorFinal","}"],["repeatn_1,repeatnError_1>exact","^+*?^$.|(){[\\0-9,}",x.exact],["repeatn_2,repeatnError_2>exact","^+*?^$.|(){[\\0-9}",x.exact],["exact,"+w+",nullChar,digitBackref,"+N+","+b+">repeat0","*",x.repeat0ToInf],["exact,"+w+",nullChar,digitBackref,"+N+","+b+">repeat1","+",x.repeat1ToInf],["exact,"+w+",nullChar,digitBackref,"+N+","+b+">repeat01","?",x.repeat0To1],["choice>repeatErrorFinal","*+?"],["repeat0,repeat1,repeat01,repeatn>repeatNonGreedy","?",x.repeatNonGreedy],["repeat0,repeat1,repeat01,repeatn>repeatErrorFinal","+*"],["start,begin,end,groupStart,groupQualifiedStart,exact,repeatNonGreedy,repeat0,repeat1,repeat01,repeatn,choice,"+w+",nullChar,digitBackref,"+N+","+b+">escape","\\",x.escapeStart],["escape>nullChar","0",x.nullChar],["nullChar>digitFollowNullError","0-9"],["escape>exact","^dDwWsSux0-9bB1-9",x.normalEscape],["escape>exact","bB",x.assertWordBoundary],["escape>exact","dDwWsS",x.charClassEscape],["escape>unicodeEscape1","u",x.exact],["unicodeEscape1>unicodeEscape2",S,x.exact],["unicodeEscape2>unicodeEscape3",S,x.exact],["unicodeEscape3>unicodeEscape4",S,x.exact],["unicodeEscape4>exact",S,x.unicodeEscape],["escape>hexEscape1","x",x.exact],["hexEscape1>hexEscape2",S,x.exact],["hexEscape2>exact",S,x.hexEscape],["escape>digitBackref","1-9",x.backref],["digitBackref>digitBackref","0-9",x.backref],["digitBackref>exact","^+*?^$.|(){[\\0-9",x.exact],["exact,begin,end,repeat0,repeat1,repeat01,repeatn,repeatNonGreedy,start,groupStart,groupQualifiedStart,choice,"+w+",nullChar,digitBackref,"+N+","+b+">groupStart","(",x.groupStart],["groupStart>groupQualify","?"],["groupQualify>groupQualifiedStart",":",x.groupNonCapture],["groupQualify>groupQualifiedStart","=",x.groupToAssertion],["groupQualify>groupQualifiedStart","!",x.groupToAssertion],[w+",nullChar,digitBackref,"+N+","+b+",groupStart,groupQualifiedStart,begin,end,exact,repeat1,repeat0,repeat01,repeatn,repeatNonGreedy,choice>exact",")",x.groupEnd],["start,begin,end,groupStart,groupQualifiedStart,exact,repeat0,repeat1,repeat01,repeatn,repeatNonGreedy,choice,"+w+",nullChar,digitBackref,"+N+","+b+">choice","|",x.choice],["start,groupStart,groupQualifiedStart,begin,exact,repeat0,repeat1,repeat01,repeatn,repeatNonGreedy,choice,"+w+",nullChar,digitBackref,"+N+","+b+">end","$",x.assertEnd],["exact,begin,end,repeat0,repeat1,repeat01,repeatn,repeatNonGreedy,groupQualifiedStart,groupStart,start,choice,"+w+",nullChar,digitBackref,"+N+","+b+">charsetStart","[",x.charsetStart],["charsetStart>charsetExclude","^",x.charsetExclude],["charsetStart>charsetContent","^\\]^",x.charsetContent],["charsetExclude>charsetContent","^\\]",x.charsetContent],["charsetContent,charsetClass>charsetContent","^\\]-",x.charsetContent],["charsetClass>charsetContent","-",x.charsetContent],[_+",charsetStart,charsetContent,charsetNullChar,charsetClass,charsetExclude,charsetRangeEnd>charsetEscape","\\"],["charsetEscape>charsetContent","^dDwWsSux0-9",x.charsetNormalEscape],["charsetEscape>charsetNullChar","0",x.charsetNullChar],["charsetEscape>charsetOctEscape","1-9"],["charsetRangeEndEscape>charsetOctEscape","1-9"],["charsetNullChar>digitFollowNullError","0-9"],["charsetNullChar>charsetContent","^0-9\\]-",x.charsetContent],["charsetEscape>charsetClass","dDwWsS",x.charsetClassEscape],["charsetEscape>charsetUnicodeEscape1","u",x.charsetContent],["charsetUnicodeEscape1>charsetUnicodeEscape2",S,x.charsetContent],["charsetUnicodeEscape2>charsetUnicodeEscape3",S,x.charsetContent],["charsetUnicodeEscape3>charsetUnicodeEscape4",S,x.charsetContent],["charsetUnicodeEscape4>charsetContent",S,x.charsetUnicodeEscape],["charsetEscape>charsetHexEscape1","x",x.charsetContent],["charsetHexEscape1>charsetHexEscape2",S,x.charsetContent],["charsetHexEscape2>charsetContent",S,x.charsetHexEscape],[_+">charsetContent","^\\]0-9a-fA-F-",x.charsetContent],[_+",charsetNullChar,charsetContent>charsetRangeStart","-",x.charsetContent],["charsetRangeStart>charsetRangeEnd","^\\]",x.charsetRangeEnd],["charsetRangeEnd>charsetContent","^\\]",x.charsetContent],["charsetRangeStart>charsetRangeEndEscape","\\"],["charsetRangeEndEscape>charsetRangeEnd","^dDwWsSux0-9bB1-9",x.charsetRangeEndNormalEscape],["charsetRangeEndEscape>charsetRangeEndWithNullChar","0"],["charsetRangeEndEscape>charsetRangeEndUnicodeEscape1","u",x.charsetRangeEnd],["charsetRangeEndUnicodeEscape1>charsetRangeEndUnicodeEscape2",S,x.charsetContent],["charsetRangeEndUnicodeEscape2>charsetRangeEndUnicodeEscape3",S,x.charsetContent],["charsetRangeEndUnicodeEscape3>charsetRangeEndUnicodeEscape4",S,x.charsetContent],["charsetRangeEndUnicodeEscape4>charsetRangeEnd",S,x.charsetRangeEndUnicodeEscape],["charsetRangeEndEscape>charsetRangeEndHexEscape1","x",x.charsetRangeEnd],["charsetRangeEndHexEscape1>charsetRangeEndHexEscape2",S,x.charsetContent],["charsetRangeEndHexEscape2>charsetRangeEnd",S,x.charsetRangeEndHexEscape],["charsetRangeEndEscape>charsetRangeEndClass","dDwWsS"],["charsetRangeEndUnicodeEscape1,charsetRangeEndHexEscape1>charsetContent","^\\]0-9a-fA-F",x.charsetContent],["charsetRangeEndUnicodeEscape2,charsetRangeEndUnicodeEscape3,charsetRangeEndUnicodeEscape4,charsetRangeEndHexEscape2>charsetRangeStart","-",x.charsetContent],[_+",charsetRangeEndUnicodeEscape1,charsetRangeEndHexEscape1,charsetRangeEndUnicodeEscape2,charsetRangeEndUnicodeEscape3,charsetRangeEndUnicodeEscape4,charsetRangeEndHexEscape2,charsetNullChar,charsetRangeStart,charsetContent,charsetClass,charsetExclude,charsetRangeEnd>exact","]"],["groupQualify>groupNamedDefined","P"],["groupNamedDefined>groupNamedStart","<"],["groupNamedStart,groupNamedContent>groupNamedContent","0-9a-zA-Z_",x.groupNamedContent],["groupNamedContent>groupNamedEnd","0-9a-zA-Z_",x.groupNamedContent],["groupNamedEnd,groupNamedContent>groupQualifiedStart",">"]]};return o}function visualize(e,t,a){var r,o=Kit();function h(e,t){if(t=t||"normal",_[e]&&_[e][t])return _[e][t];r.attr({"font-size":e,"font-weight":t});var a=r.getBBox();return _[e]=_[e]||{},_[e][t]={width:a.width/((r.attr("text").length-1)/2),height:a.height/2}}function C(e,t,a){e.forEach(function(e){e._translate?e._translate(t,a):(e.x+=t,e.y+=a)})}function l(a,e,r){var t,n=[],s=[],c=0,i=e,o=r,h=r;if(!a.length)return k.empty(a,e,r);a.forEach(function(e){e=e.repeat?k.repeat(e,i,r):k[e.type](e,i,r),n.push(e),i+=e.width+16,c+=e.width,o=Math.min(o,e.y),h=Math.max(h,e.y+e.height),s=s.concat(e.items)}),t=h-o,n.reduce(function(e,t){return c+=16,e=g(a,e.lineOutX,r,t.lineInX,_fromItem=e,_toItem=t),s.push(e),t});var p=n[0].lineInX,u=n[n.length-1].lineOutX;return{items:s,width:c,height:t,x:e,y:o,lineInX:p,lineOutX:u}}function S(e,t,a,r,n,s){t=o.toPrint(t);var c=h(16),i=t.length*c.width,c=c.height+12,i=12+i,n={type:"rect",class:`rect:${e.type}:`+e.indices.join(";"),x:a,y:r-c/2,width:i,height:c,stroke:"none",fill:n||"transparent"};return{text:s={type:"text",class:`text:${e.type}:`+e.indices.join(";"),x:a+i/2,y:r,text:t,"font-size":16,"font-family":y,fill:s||"black"},rect:n,items:[n,s],width:i,height:c,x:a,y:n.y,lineInX:a,lineOutX:a+i}}function w(e,t,a,r,n){var s=h(14),c=(i=r.split("\n")).length*s.height,i=1<i.length?Math.max.apply(Math,i.map(function(e){return e.length})):r.length;return i*=s.width,{label:{type:"text",class:`text:${e.type}:`+e.indices.join(";"),x:t,y:a-c/2-4,text:r,"font-size":14,"font-family":y,fill:n||"#444"},x:t-i/2,y:a-c-4,width:i,height:4+c}}function g(e,t,a,r,n=null,s=null){let c="linejoint";return null!==n&&(c=c+"::"+n.items.map(e=>e.class).join("_")),null!==s&&(c=`${c}::${s.items.map(e=>e.class).join("_")}::`),{type:"path",class:"path:"+(c=e.hasOwnProperty("indices")?"curve:"+e.indices.join(";"):c),x:t,y:a,path:["M",t,a,"H",r],"stroke-linecap":"butt","stroke-linejoin":"round",stroke:"#333","stroke-width":2,_translate:function(e,t){var a=this.path;a[1]+=e,a[2]+=t,a[4]+=e}}}function E(e,t,a,r,n){var s,c=r<t?-1:1,i=n<a?-1:1,r=Math.abs(a-n)<15?(s=["M",t,a,"C",t+Math.min(Math.abs(r-t)/2,10)*c,a,r-(r-t)/2,n,r,n],function(e,t){var a=this.path;a[1]+=e,a[2]+=t,a[4]+=e,a[5]+=t,a[6]+=e,a[7]+=t,a[8]+=e,a[9]+=t}):(s=["M",t,a,"Q",t+10*c,a,t+10*c,a+10*i,"V",Math.abs(a-n)<20?a+10*i:n-10*i,"Q",t+10*c,n,t+10*c*2,n,"H",r],function(e,t){var a=this.path;a[1]+=e,a[2]+=t,a[4]+=e,a[5]+=t,a[6]+=e,a[7]+=t,a[9]+=t,a[11]+=e,a[12]+=t,a[13]+=e,a[14]+=t,a[16]+=e});return{type:"path",class:"path:curve:"+e.indices.join(";"),path:s,"stroke-linecap":"butt","stroke-linejoin":"round",stroke:"#333","stroke-width":2,_translate:r}}function n(e,t,a,r){return{items:[{type:"circle",class:`circle:${e.type}:`+e.indices.join(";"),fill:r,cx:t+10,cy:a,r:10,stroke:"none",_translate:function(e,t){this.cx+=e,this.cy+=t}}],width:20,height:20,x:t,y:a,lineInX:t,lineOutX:t+20}}function x(e){if(Array.isArray(e)){for(var t=e,a=0;a<t.length;a++)if(!x(t[a]))return!1;return!0}return e.type===EMPTY_NODE||(e.type===GROUP_NODE&&void 0===e.num?x(e.sub):e.type===CHOICE_NODE?x(e.branches):void 0)}function c(e){return(e=o.toPrint(e)).replace(/\[/g,"\\[").replace(/\]/g,"\\]")}function i(e,t){return{type:"text","font-size":16,"font-family":y,text:e+"",fill:t=t||O[e]||O.defaults,"text-anchor":"start","font-weight":"bold"}}function b(e){return!e.chars&&!e.ranges.length&&1===e.classes.length}var s,p,u,d,f,m,y="DejaVu Sans Mono,monospace",N=!1,_={},k={startPoint:function(e,t,a){return n({type:"startPoint",indices:[-1,-1]},t,a,"r(0.5,0.5)#EFE-green")},endPoint:function(e,t,a){return n({type:"endPoint",indices:[1/0,1/0]},t,a,"r(0.5,0.5)#FFF-#000")},empty:function(e,t,a){return{items:[g(e,t,a,t+10)],width:10,height:2,x:t,y:a,lineInX:t,lineOutX:t+10}},exact:function(e,t,a){return S(e,e.chars,t,a,"skyblue")},dot:function(e,t,a){return(a=S(e,"AnyCharExceptNewLine",t,a,"DarkGreen","white")).rect.r=10,a.rect.tip="AnyChar except CR LF",a},backref:function(e,t,a){return(a=S(regexJSONInfom,"Backref #"+e.num,t,a,"navy","white")).rect.r=8,a},repeat:function(e,t,a){function r(e){return e+(e<2?" time":" times")}function n(e,t){var a=this.path;a[1]+=e,a[2]+=t,a[4]+=e,a[5]+=t,a[6]+=e,a[7]+=t,a[9]+=t,a[11]+=e,a[12]+=t,a[13]+=e,a[14]+=t,a[16]+=e,a[18]+=e,a[19]+=t,a[20]+=e,a[21]+=t,a[23]+=t,a[25]+=e,a[26]+=t,a[27]+=e,a[28]+=t}if(x(e))return k.empty(e,t,a);var s=e.repeat,c="",i=[];if(s.min===s.max&&0===s.min)return k.empty(e,t,a);var o=k[e.type](e,t,a),h=o.width,p=o.height;if(s.min===s.max&&1===s.min)return o;s.min===s.max?c+=r(s.min):(c+=s.min,isFinite(s.max)?c+=(1<s.max-s.min?" to ":" or ")+r(s.max):c+=" or more times");var u,d,l=10,g=0,E=o.y+o.height-a,f=20+o.width,h=f;return 1!==s.max?(E+=10,p+=10,u={type:"path",class:"path:curve:"+e.indices.join(";"),path:["M",o.x+10,a,"Q",t,a,t,a+10,"V",a+E-10,"Q",t,a+E,t+10,a+E,"H",t+f-10,"Q",t+f,a+E,t+f,a+E-10,"V",a+10,"Q",t+f,a,o.x+o.width+10,a],_translate:n,stroke:"maroon","stroke-width":2},s.nonGreedy&&(u.stroke="Brown",u["stroke-dasharray"]="-"),i.push(u)):c=!1,0===s.min&&(d=a-o.y+10,l+=10,g=-12,h=f+=20,p+=10,s={type:"path",class:"path:curve:"+e.indices.join(";"),path:["M",t,a,"Q",t+10,a,t+10,a-10,"V",a-d+10,"Q",t+10,a-d,t+20,a-d,"H",t+f-20,"Q",t+f-10,a-d,t+f-10,a-d+10,"V",a-10,"Q",t+f-10,a,t+f,a],_translate:n,stroke:s.nonGreedy?"darkgreen":"#333","stroke-width":2},u&&C([u],10,0),i.push(s)),c&&(C([(c=w(e,t+h/2,a,c)).label],0,E+c.height+4),i.push(c.label),p+=4+c.height,(E=(Math.max(c.width,h)-h)/2)&&C(i,E,0),h=Math.max(c.width,h),l+=E),C(o.items,l,0),{items:i=i.concat(o.items),width:h,height:p,x:t,y:o.y+g,lineInX:o.lineInX+l,lineOutX:o.lineOutX+l}},choice:function(s,c,i){if(x(s))return k.empty(s,c,i);var t=0,o=0,e=s.branches.map(function(e){return e=l(e,c,i),t+=e.height,o=Math.max(o,e.width),e}),h=(t+=6*(e.length-1)+8,c+(o+=40)/2),p=i-t/2+4,u=c+o,d=[];return e.forEach(function(e){var t=h-e.width/2,a=(C(e.items,t-e.x,p-e.y),d=d.concat(e.items),i+p-e.y),r=E(s,c,i,c+20,a),n=E(s,u,i,c+o-20,a);d.push(r,n),c+20!==t-e.x+e.lineInX&&d.push(g(s,c+20,a,t-e.x+e.lineInX)),e.lineOutX+t-e.x!=c+o-20&&d.push(g(s,e.lineOutX+t-e.x,a,c+o-20)),e.x=t,e.y=p,p+=e.height+6}),{items:d,width:o,height:t,x:c,y:i-t/2,lineInX:c,lineOutX:u}},charset:function(t,a,r){var e,n,s={d:"Digit",D:"NonDigit",w:"Word",W:"NonWord",s:"WhiteSpace",S:"NonWhiteSpace"},c=t.exclude?"Pink":"Khaki",i=t.exclude?"#C00":"";if(b(t))return(e=S(t,s[t.classes[0]],a,r,"Green","white")).rect.r=5,t.exclude?(n=w(t,e.x+e.width/2,e.y,"None of:",i),(x=e.items).push(n.label),y=e.width,h=Math.max(n.width,e.width),C(x,m=(h-y)/2,0),{items:x,width:h,height:e.height+n.height,x:Math.min(n.x,e.x),y:n.y,lineInX:m+e.x,lineOutX:m+e.x+e.width}):e;if(!t.chars&&!t.ranges.length&&!t.classes.length)return(e=S(t,"AnyChar",a,r,"green","white")).rect.r=5,e;var o=[],h=0,p=0;t.chars&&((l=S(t,t.chars,a,r,"LightSkyBlue","black")).rect.r=5,o.push(l),h=l.width),t.ranges.forEach(function(e){e=e.split("").join("-"),(e=S(t,e,a,r,"teal","white")).rect.r=5,o.push(e),h=Math.max(e.width,h)}),t.classes.forEach(function(e){(e=S(t,s[e],a,r,"Green","white")).rect.r=5,o.push(e),h=Math.max(e.width,h)});var u,d,l=o[0].height,g=[],E=[];for(o.sort(function(e,t){return t.width-e.width}),o.forEach(function(e){(2*e.width+4>h?g:E).push(e)}),o=g;E.length;){if(u=E.pop(),!(d=E.pop())){o.push(u);break}2<u.width-d.width?(o.push(u),E.push(d)):(C(d.items,u.width+4,0),o.push({items:u.items.concat(d.items),width:u.width+d.width+4,height:u.height,x:u.x,y:u.y}),p-=u.height)}h+=12;var p=4*(o.length-1)+o.length*l+12,f=(c={type:"rect",class:"rect:charsetgroup:"+t.indices.join(";"),x:a,y:r-p/2,r:4,width:h,height:p,stroke:"none",fill:c}).y+6,x=[c];o.forEach(function(e){C(e.items,a-e.x+(h-e.width)/2,f-e.y),x=x.concat(e.items),f+=e.height+4}),n=w({type:"charsetgroup",indices:t.indices},c.x+c.width/2,c.y,(t.exclude?"None":"One")+" of:",i),x.push(n.label);var m,y=h,h=Math.max(n.width,h);return C(x,m=(h-y)/2,0),{items:x,width:h,height:p+n.height,x:Math.min(n.x,a),y:n.y,lineInX:m+a,lineOutX:m+a+c.width}},group:function(e,t,a){if(x(e))return k.empty(e,t,a);var r,n,s,c,i,o=l(e.sub,0,0),h={type:"group",class:`g:${e.type}:${[e.indices[0]+1,e.indices[1]-1].join(";")}:t${o.x},`+o.y,subs:o.items,transform:`t${o.x},`+o.y,x:o.x,y:o.y,width:o.width,height:o.height};return e.num?(C(o.items,10,0),s=o.width+20,c=o.height+20,r={type:"rect",class:`rect:${e.type}:`+e.indices.join(";"),x:t,y:o.y-10,r:6,width:s,height:c,"stroke-dasharray":".",stroke:"silver","stroke-width":2},i=w(e,r.x+r.width/2,r.y-2,`Group ${e.name}#`+e.num),s=((n=Math.max(i.width,s))-s)/2,c={type:"group",class:`g:${e.type}:`+e.indices.join(";"),subs:[h,r,i.label],transform:`t${t+s},`+a,x:t+s,y:a,width:n,height:c+i.height+4},i=o.items.concat([r,i.label]),s&&C(i,s,0),{items:[c],width:c.width,height:c.height,x:t+s,y:a,lineInX:s+o.lineInX+10,lineOutX:s+o.lineOutX+10}):{items:[h],width:h.width,height:h.height,x:o.x,y:o.y,lineInX:o.lineInX,lineOutX:o.lineOutX}},assert:function(e,t,a){var r=(s=e.assertionType).replace("Assert","")+"!";if(n={AssertNonWordBoundary:{bg:"maroon",fg:"white"},AssertWordBoundary:{bg:"purple",fg:"white"},AssertEnd:{bg:"Indigo",fg:"white"},AssertBegin:{bg:"Indigo",fg:"white"}}[s])return S(e,r=!N||"AssertBegin"!==s&&"AssertEnd"!==s?r:"Line"+r,t,a,n.bg,n.fg);s===AssertLookahead?(c="CornflowerBlue",i="darkgreen",r="Followed by:"):s===AssertNegativeLookahead&&(c="#F63",i="Purple",r="Not followed by:");var n=k.group(e,t,a),s=n.height+16,a=n.width+16,c={type:"rect",class:`rect:${e.type}:`+e.indices.join(";"),x:t,y:n.y-8,r:6,width:a,height:s,"stroke-dasharray":"-",stroke:c,"stroke-width":2},r=w(e,c.x+a/2,c.y,r,i),i=Math.max(a,r.width),a=(i-a)/2;return C(n.items,8+a,0),a&&C([c,r.label],a,0),{items:n.items.concat([c,r.label]),width:i,height:c.height+r.height,x:t,y:r.y,lineInX:a+n.lineInX+8,lineOutX:a+n.lineOutX+8}}},O={delimiter:"Indigo",flags:"darkgreen",exact:"#334",dot:"darkblue",backref:"teal",$:"purple","^":"purple","\\b":"#F30","\\B":"#F30","(":"blue",")":"blue","?=":"darkgreen","?!":"red","?:":"grey","[":"navy","]":"navy","|":"blue","{":"maroon",",":"maroon","}":"maroon","*":"maroon","+":"maroon","?":"maroon",repeatNonGreedy:"#F61",defaults:"black",charsetRange:"olive",charsetClass:"navy",charsetExclude:"red",charsetChars:"#534"};a.clear(),a.setSize(0,0),(p=a.rect(0,0,0,0)).attr("fill","#EEE"),p.attr("stroke","#EEE"),r=a.text(-1e3,-1e3,"XgfTlM|.q\nXgfTlM|.q").attr({"font-family":y,"font-size":16}),N=!!~t.indexOf("m"),(s=function n(e){var s=[];return e.forEach(function(e){var t,a,r;e.sub?(s.push(i("(")),e.type===ASSERT_NODE?e.assertionType===AssertLookahead?s.push(i("?=")):s.push(i("?!")):""!==e.name?s.push(i(`?P<${e.name}>`)):e.nonCapture&&s.push(i("?:")),(s=s.concat(n(e.sub))).push(i(")"))):e.branches?(e.branches.map(n).forEach(function(e){(s=s.concat(e)).push(i("|"))}),s.pop()):(r=O[e.type]||O.defaults,e.type===CHARSET_NODE?((t=b(e))&&!e.exclude||s.push(i("[")),e.exclude&&s.push(i("^",O.charsetExclude)),e.ranges.forEach(function(e){s.push(i(c(e[0]+"-"+e[1]),O.charsetRange))}),e.classes.forEach(function(e){s.push(i("\\"+e,O.charsetClass))}),s.push(i(c(e.chars),O.charsetChars)),t&&!e.exclude||s.push(i("]"))):(a=e.raw||"",e.repeat&&(a=a.slice(0,e.repeat.beginIndex)),a=o.toPrint(a,!0),s.push(i(a,r)))),e.repeat&&(a=e.repeat.min,r=e.repeat.max,0===a&&r===1/0?s.push(i("*")):1===a&&r===1/0?s.push(i("+")):0===a&&1===r?s.push(i("?")):(s.push(i("{")),s.push(i(a)),a!==r&&(s.push(i(",")),isFinite(r)&&s.push(i(r))),s.push(i("}"))),e.repeat.nonGreedy&&s.push(i("?",O.repeatNonGreedy)))}),s}(e.tree)).unshift(i("/",O.delimiter)),s.unshift(i("RegExp: ")),s.push(i("/",O.delimiter)),t&&s.push(i(t,O.flags)),u=h(16,"bold"),d=u.height/2+10,f=s.reduce(function(e,t){return t.x=e,t.y=d,e+t.text.length*u.width},10),f+=10,m=u.height+20,s=a.add(s),a.setSize(f,u.height+20),s=0,(t=e.tree).unshift({type:"startPoint"}),t.push({type:"endPoint"}),e=l(t,s,0),m=Math.max(e.height+30+u.height,m),f=Math.max(e.width+20,f),a.setSize(f,m),p.attr("width",f),p.attr("height",m),C(e.items,10,20+u.height-e.y),a.addv2(e.items)}