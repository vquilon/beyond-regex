var RegexVisualizerPanel=function(e){var r,i,o=document.getElementById("input"),s=(document.getElementById("terminal-error .errorBox"),document.getElementById("visualizeClick")),t=document.getElementById("exportIt");const n=!o&&!s;i=n?(r=e.editorParser.getParams(),e.editorParser.parseSharedRegex):e.editorParser.parseRegex,e.editorParser.trim;const l=e.editorParser.getReLanguage,c=e.editorParser.getFlags;e.editorParser.setFlags;const d=e.editorParser.getInputValue,m=e.editorParser._updateRaphaelItemsJSON;var u,g,p,h=document.querySelector(`#${e.loader_view_id}`),v=h.querySelector(`.${e.progress_bar_class}`),f=new Raphael("visualizer-graphView",10,10);f.canvas.id="visualizer-graphSVG";const a=()=>{var e,t=o.value,a=i(t);return a?(s.disabled=!0,h.classList.add("loading"),v.updateProgressBar=function(e){this.attributes.getNamedItem("data-value").value=`${e}`,this.style.transform=`scaleX(${e/100})`},window.setTimeout(()=>{e=RegexVisualizer(a,c(),f,v),m(e),p&&p(),[u,g,p]=CustomThumbnailSVGControl({mainViewId:"visualizer-graphView",mainSVGId:"visualizer-graphSVG",thumbContainerId:"thumbViewContainer"}),h.classList.remove("loading"),v.attributes.getNamedItem("data-value").value="0",v.style.transform="",s.disabled=!1},0),!0):!(s.disabled=!0)};function y(){let e="",t="",a;return a=n?(e=r.re,t=r.flags,r.reLang):(e=d(),t=c(),l()),`<iframe frameborder="0" 
            width="500px" height="300px" 
            src="${`${location.href}/panels/visualizer`}#!embed=true&flags=${t}&re=${encodeURIComponent(e)}&reLang=${a}">
            </iframe>`}function w(e){return(new XMLSerializer).serializeToString(e)}const S=async(c,d,m,e="svg")=>{let u=f.canvas.cloneNode(!0),t=u.querySelector("g#mainSVGViewPort");t.removeAttribute("transform"),t.removeAttribute("style");let a=t.querySelector("g#mainSVGContainer");a.removeChild(a.querySelector("desc")),a.removeChild(a.querySelector("defs"));let r=a.firstElementChild;r.style.stroke="none",r.style.strokeWidth="";var i=(e,o,t="",a="",s="")=>{e.style.fill=t||e.style.fill||e.getAttribute("fill"),e.style.stroke=a||e.style.stroke||e.getAttribute("stroke"),e.style.strokeWidth=s||e.style.strokeWidth||e.getAttribute("stroke-width"),s=window.devicePixelRatio||1;let n=parseFloat(e.getAttribute("width")),l=parseFloat(e.getAttribute("height"));if(u.removeAttribute("xmlns:xlink"),"svg"===o&&(e=`data:image/svg+xml,${encodeURIComponent(w(u))}`,d.setAttribute("src",e),m.setAttribute("href",e)),"png"===o){o=u.outerHTML,c.width=n*s,c.height=l*s;let t=c.getContext("2d");t.setTransform(s,0,0,s,0,0),w(u);let a=self.URL||self.webkitURL||self,r=new Image;o=new Blob([o],{type:"image/svg+xml;charset=utf-8"});let i=a.createObjectURL(o);r.onload=function(){t.drawImage(r,0,0,n,l);var e=c.toDataURL("image/png");a.revokeObjectURL(i),d.setAttribute("src",e),m.setAttribute("href",e)},r.src=i}};return i(r,e),{$img:d,rectBackground:r,updateBackgroundStyle:i}};return document.querySelector("#share-visualize").addEventListener("click",e=>{const t=new Promise(e=>{e({panelURL:y()})});t.then(e=>{Swal.fire({title:"Share the interactive graph!",icon:"info",iconHtml:'<span class="sweetalert-icon material-icons">image</span>',html:`
                <div id="visualizer-iframe-copy" class="container-copy">
                    <div class="iframe-copier">
                        <div class="iframe-content">
                            <span>${e.panelURL.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</span>
                        </div>
                        <div class="wrap-copy-iframe"><button class="copy-iframe"><i class="far fa-copy"></i></button></div>
                    </div>
                </div>
                <canvas style="display:none; width: 100%; height: unset;" id="export-image"></canvas>
                
                <a class="anchor-export-img" href="" download="graph-regex.png"><img id="exported-img" src=""><span><i class="fas fa-download"></i>SVG</span></a>
                `,showCancelButton:!0,showConfirmButton:!1,showCloseButton:!0,cancelButtonText:"Close",didOpen:()=>{Swal.showLoading(),document.querySelector("#visualizer-iframe-copy button.copy-iframe").addEventListener("click",function(){navigator.clipboard.writeText(e.panelURL),document.querySelector("#visualizer-iframe-copy .copy-iframe>i").className="fas fa-check",document.querySelector("#visualizer-iframe-copy .iframe-copier").classList.add("copied"),setTimeout(function(){var e=document.querySelector("#visualizer-iframe-copy .copy-iframe>i");let t=document.querySelector("#visualizer-iframe-copy .iframe-copier");e&&t&&t.classList.remove("copied")},1e3)});var{}=S(document.querySelector("canvas#export-image"),document.querySelector("img#exported-img"),document.querySelector("img#exported-img").parentElement,imageType="svg");Swal.hideLoading()}})})}),n?(e=r.re,(e=i(e,language_selected=r.reLang))&&(h.classList.add("loading"),v.updateProgressBar=function(e){this.attributes.getNamedItem("data-value").value=`${e}`,this.style.transform=`scaleX(${e/100})`},RegexVisualizer(e,c(),f,v),[u,g,p]=CustomThumbnailSVGControl({mainViewId:"visualizer-graphView",mainSVGId:"visualizer-graphSVG",thumbContainerId:"thumbViewContainer"}),h.classList.remove("loading"),v.attributes.getNamedItem("data-value").value="0",v.style.transform="")):(s.addEventListener("click",e=>{e.detail&&1!=e.detail||a()}),t.addEventListener("click",e=>{Swal.fire({title:"Share the Image Graph (PNG)!",icon:"info",iconHtml:'<span class="sweetalert-icon material-icons">image</span>',html:`
                <canvas style="display:none; width: 100%; height: unset;" id="export-image"></canvas>
                
                <a class="anchor-export-img" href="" download="graph-regex.png"><img id="exported-img" src=""><span><i class="fas fa-download"></i>PNG</span></a>
                `,showCancelButton:!0,showConfirmButton:!1,showCloseButton:!0,cancelButtonText:"Close",didOpen:()=>{Swal.showLoading();var{}=S(document.querySelector("canvas#export-image"),document.querySelector("img#exported-img"),document.querySelector("img#exported-img").parentElement,imageType="png");Swal.hideLoading()}})}),a()),{generatePanelURL:y}};